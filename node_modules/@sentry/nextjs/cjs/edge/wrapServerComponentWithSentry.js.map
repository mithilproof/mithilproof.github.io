{"version":3,"file":"wrapServerComponentWithSentry.js","sources":["../../../src/edge/wrapServerComponentWithSentry.ts"],"sourcesContent":["import { captureException } from '@sentry/core';\n\nimport type { ServerComponentContext } from '../common/types';\n\n/**\n * Wraps an `app` directory server component with Sentry error instrumentation.\n */\nexport function wrapServerComponentWithSentry<F extends (...args: any[]) => any>(\n  appDirComponent: F,\n  _context: ServerComponentContext,\n): F {\n  // Even though users may define server components as async functions, for the client bundles\n  // Next.js will turn them into synchronous functions and it will transform any`await`s into instances of the`use`\n  // hook. ðŸ¤¯\n  return new Proxy(appDirComponent, {\n    apply: (originalFunction, thisArg, args) => {\n      let maybePromiseResult;\n\n      try {\n        maybePromiseResult = originalFunction.apply(thisArg, args);\n      } catch (e) {\n        captureException(e);\n        throw e;\n      }\n\n      if (typeof maybePromiseResult === 'object' && maybePromiseResult !== null && 'then' in maybePromiseResult) {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n        return maybePromiseResult.then(null, (e: Error) => {\n          captureException(e);\n          throw e;\n        });\n      } else {\n        return maybePromiseResult;\n      }\n    },\n  });\n}\n"],"names":["captureException"],"mappings":";;;;AAIA;AACA;AACA;AACA,SAAA,6BAAA;AACA,EAAA,eAAA;AACA,EAAA,QAAA;AACA,EAAA;AACA;AACA;AACA;AACA,EAAA,OAAA,IAAA,KAAA,CAAA,eAAA,EAAA;AACA,IAAA,KAAA,EAAA,CAAA,gBAAA,EAAA,OAAA,EAAA,IAAA,KAAA;AACA,MAAA,IAAA,kBAAA,CAAA;AACA;AACA,MAAA,IAAA;AACA,QAAA,kBAAA,GAAA,gBAAA,CAAA,KAAA,CAAA,OAAA,EAAA,IAAA,CAAA,CAAA;AACA,OAAA,CAAA,OAAA,CAAA,EAAA;AACA,QAAAA,qBAAA,CAAA,CAAA,CAAA,CAAA;AACA,QAAA,MAAA,CAAA,CAAA;AACA,OAAA;AACA;AACA,MAAA,IAAA,OAAA,kBAAA,KAAA,QAAA,IAAA,kBAAA,KAAA,IAAA,IAAA,MAAA,IAAA,kBAAA,EAAA;AACA;AACA,QAAA,OAAA,kBAAA,CAAA,IAAA,CAAA,IAAA,EAAA,CAAA,CAAA,KAAA;AACA,UAAAA,qBAAA,CAAA,CAAA,CAAA,CAAA;AACA,UAAA,MAAA,CAAA,CAAA;AACA,SAAA,CAAA,CAAA;AACA,OAAA,MAAA;AACA,QAAA,OAAA,kBAAA,CAAA;AACA,OAAA;AACA,KAAA;AACA,GAAA,CAAA,CAAA;AACA;;;;"}